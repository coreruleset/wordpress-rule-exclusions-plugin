---
meta:
  author: "Esad Cetiner"
  description: "Wordpress Rule Exclusions Plugin: Obtaining metadata about pages/posts such as tags, categories, authors, etc"
rule_id: 9507151
tests:
  - test_id: 1
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: example.com
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          version: "HTTP/1.1"
          uri: /wp-json/wp/v2/tags?context=view&per_page=10&orderby=count&order=desc&hide_empty=true&_fields=id%2Cname%2Ccount&_locale=user
        output:
          log:
            no_expect_ids: [932236]
  - test_id: 2
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: example.com
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          version: "HTTP/1.1"
          uri: /wp-json/wp/v2/categories?context=edit&per_page=100&orderby=id&order=asc&_fields=id%2Cname&_locale=user
        output:
          log:
            no_expect_ids: [932236]
  - test_id: 3
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: example.com
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          version: "HTTP/1.1"
          uri: /wp-json/wp/v2/wp_pattern_category?context=view&per_page=100&_fields=id%2Cname%2Cdescription%2Cslug&_locale=user
        output:
          log:
            no_expect_ids: [932236]
  - test_id: 4
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: example.com
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          version: "HTTP/1.1"
          uri: /wp-json/wp/v2/users/1?context=view&_fields=id%2Cname&_locale=user
        output:
          log:
            no_expect_ids: [932236]
  - test_id: 5
    stages:
      - input:
          dest_addr: 127.0.0.1
          headers:
            Host: example.com
            User-Agent: OWASP CRS test agent
            Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
          port: 80
          method: GET
          version: "HTTP/1.1"
          uri: /wp-json/wp/v2/pages?context=edit&per_page=100&_fields=id%2Clink%2Cmenu_order%2Cparent%2Ctitle%2Ctype&orderby=menu_order&order=asc&_locale=user
        output:
          log:
            no_expect_ids: [932236]
